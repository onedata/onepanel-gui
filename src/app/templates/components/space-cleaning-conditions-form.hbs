<div class="row content-row no-border no-padding-top">
  <h1 class="selective-cleaning-header">
    <label>{{t "components.spaceAutoCleaning.cleanReplicatedFiles"}}</label>
    {{#one-label-tip
      class="selective-cleaning-hint"
      placement="top"
    }}
      {{tt this "conditionsHintEnabledBegin"}}
      <strong>{{tt this "conditionsHintEnabledStrong"}}</strong>
      {{tt this "conditionsHintEnabledEnd"}}
      <br>
      {{tt this "conditionsHintDisabled"}}
    {{/one-label-tip}}
    <span class="form-state">
      {{#if (eq _formStatus "saving")}}
        <span class="animated infinite semi-hinge pulse-mint">{{t "components.spaceCleaningConditionsForm.saving"}}</span>
      {{else if (eq _formStatus "modified")}}
        {{t "components.spaceCleaningConditionsForm.modified"}}
      {{else if (eq _formStatus "saved")}}
        {{t "components.spaceCleaningConditionsForm.saved"}}
      {{else if (eq _formStatus "failed")}}
        <span class="text-danger">{{t "components.spaceCleaningConditionsForm.updateFailed"}}</span>
      {{/if}}
    </span>
    {{one-way-toggle
      class="selective-cleaning-toggle"
      checked=isEnabled
      update=(action "configureEnabled")
      spinnerSide="left"
    }}
  </h1>
</div>
{{#bs-form class=(concat "selective-cleaning-rules-form collapse-animation collapse-small collapse-blurred " (unless isEnabled "collapse-hidden")) as |form|}}
  {{#each _sourceFieldNames as |fieldName|}}
    {{#form.group 
      class=(concat-classes (concat fieldName "Group") (if (get _formFieldsErrors fieldName) "has-error"))
    }}
      <div class="toggle-column">
        {{one-checkbox 
          class="item-checkbox"
          isReadOnly=(eq _formStatus "saving")
          checked=(get _formData (concat fieldName "Enabled"))
          update=(action "dataChanged" (concat fieldName "Enabled"))
        }}
      </div>
      <label for={{concat elementId fieldName}} class="label-column control-label {{if (not (get _formData (concat fieldName "Enabled"))) "disabled"}}">
        {{t (concat "components.spaceCleaningConditionsForm." fieldName)}}
      </label>
      <div class="fields-column">
        {{one-way-input
          value=(get _formData (concat fieldName "Number"))
          disabled=(or (not (get _formData (concat fieldName "Enabled"))) (eq _formStatus "saving"))
          class="condition-number-input form-control input-sm"
          focusOut=(action "lostFocus")
          update=(action "dataChanged" (concat fieldName "Number"))
          onenter=(action "forceSave")
          id=(concat elementId fieldName)}}
        {{#if (get _formData (concat fieldName "Unit"))}}
          {{#power-select
            triggerClass="small"
            dropdownClass="small"
            disabled=(or (not (get _formData (concat fieldName "Enabled"))) (eq _formStatus "saving"))
            options=(if (eq fieldName "minHoursSinceLastOpen") _timeUnits _sizeUnits)
            selected=(get _formData (concat fieldName "Unit"))
            onchange=(action "dataChanged" (concat fieldName "Unit"))
            searchEnabled=false
            renderInPlace=true
            as |unit|}}
            {{unit.name}}
          {{/power-select}}
        {{else}}
          <div class={{concat "static-condition-unit " (if (or (not (get _formData (concat fieldName "Enabled"))) (eq _formStatus "saving")) "disabled")}}>
            {{t "components.spaceCleaningConditionsForm.times"}}
          </div>
        {{/if}}
      </div>
      <div class="hint-column">
        {{one-label-tip
          title=(t (concat "components.spaceCleaningConditionsForm.hint." fieldName))
          class="condition-hint"
        }}
      </div>
    {{/form.group}}
  {{/each}}
{{/bs-form}}